name: Workflow Test

on:
  workflow_call:
    inputs:
      environment:
          required: true
          type: string
          description: 'Env Value'
    secrets:
      server:
        required: true        
        description: 'Server to login to'
  
jobs:

  azure-login:
    name: Validation
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment }}
   
    env:
      SERVER: ${{ secrets.server }}
      
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Process
        if: ${{vars.process == 'true'}}
        run: |
          echo "Validation-Process:" ${{ vars.process }}
     
  check-step:
    name: step1
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment }}
    needs: azure-login

    steps:
      # - name: Process1
      #   if: ${{vars.process == true}}
      #   run: |
      #     echo "Process 1:" ${{ vars.process }}
      # - name: Process2
      #   if: ${{vars.process != 'true'}}
      #   run: |
      #     echo "Process 2:" ${{ vars.process }}
      #     exit 1
      - name: Process3
        if: ${{vars.process == 'true'}}
        run: |
          echo "Process 3:" ${{ vars.process }}

  re-process-step:
    name: Re-Process Step
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment }}
    needs: check-step
    continue-on-error: true
    #if: ${{vars.process == 'true'}}

    steps:
      - name: Process        
        run: |
          echo "Re-Process Step:" ${{ vars.process }}
          
        