name: Workflow Test

on:
  workflow_call:
    inputs:
      environment:
          required: true
          type: string
          description: 'Env Value'
    secrets:
      server:
        required: true        
        description: 'Server to login to'
  
jobs:

  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Set env
      run: echo "GITHUB_SHA_SHORT=$(echo $GITHUB_SHA | cut -c 1-6)" >> $GITHUB_ENV
    - name: Test
      run: echo $GITHUB_SHA_SHORT

  # azure-login:
  #   name: Validation
  #   runs-on: ubuntu-latest
  #   environment: ${{ inputs.environment }}
   
  #   env:
  #     SERVER: ${{ secrets.server }}
      
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v3

  #     - name: Process
  #       if: ${{vars.process == 'true'}}
  #       run: |
  #         echo "Validation-Process:" ${{ vars.process }}
     
  step1:
    name: step1
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment }}
    steps:      
      - name: ProcessStep1
        if: ${{vars.process != 'process'}}
        run: |
          echo "Step1 Process:" ${{ vars.process }}
          exit 1
      - name: ProcessStep2
        if: ${{vars.process == 'process'}}
        run: |
          echo "Step2 Process:" ${{ vars.process }}

  # Step2:
  #   name: Step2    
  #   if: step1.outputs.status == 'success'
  #   runs-on: ubuntu-latest
  #   environment: ${{ inputs.environment }}    
  #   needs: Step1
  #   #continue-on-error: true    

  #   steps:
  #     - name: ProcessStep2
  #       run: |
  #         echo "Step2 Process:" ${{ vars.process }}
        